{{!-- Attendance Lock (Refined) --}}
 
<div class="container-fluid">
	<div class="row">
		<div class="col-md-3 col-lg-2 px-0">
			{{> sidebar active="attendance-lock" activeGroup="attendance"}}
		</div>
		<div class="col-md-9 col-lg-10">
			<div class="main-content p-4">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb mb-3 bg-transparent p-0">
						<li class="breadcrumb-item"><a href="/admin">Admin</a></li>
						<li class="breadcrumb-item"><a href="/admin/attendance">Attendance</a></li>
						<li class="breadcrumb-item active" aria-current="page">Lock Attendance</li>
					</ol>
				</nav>

				<div class="card">
					<div class="card-header d-flex justify-content-between align-items-center">
						<span><i class="fa-solid fa-lock me-2"></i> Lock Attendance Period</span>
					</div>
					<div class="card-body">
						<form onsubmit="lockAttendance(event)" class="row g-3">
							<div class="col-md-4">
								<label class="form-label">Period (YYYY-MM)</label>
								<input type="month" name="period" class="form-control" required>
							</div>
							<div class="col-md-4 d-flex align-items-end">
								<button type="submit" class="btn btn-danger w-100">
									<i class="fa-solid fa-lock"></i> Lock Period
								</button>
							</div>
						</form>
						<div class="alert alert-warning mt-4" role="alert">
							<i class="fa-solid fa-triangle-exclamation me-2"></i>
							<strong>Warning:</strong> Once locked, attendance for the selected period cannot be modified. Make sure all corrections are completed before locking.
						</div>
					</div>
				</div>

				<div class="card mt-4">
					<div class="card-header">
						<span><i class="fa-solid fa-unlock me-2"></i> Unlock Period</span>
					</div>
					<div class="card-body">
						<p class="text-muted mb-3">Use this to unlock a previously locked attendance period. This action requires a reason and will be logged.</p>
						<button class="btn btn-warning" onclick="unlockAttendance()">
							<i class="fa-solid fa-unlock"></i> Unlock Period
						</button>
					</div>
				</div>

				<div class="card mt-4">
					<div class="card-header d-flex justify-content-between align-items-center">
						<span><i class="fa-solid fa-list me-2"></i> Locked Periods</span>
						<button class="btn btn-sm btn-outline-primary" onclick="loadLockedPeriods()">
							<i class="fa-solid fa-rotate-right"></i> Refresh
						</button>
					</div>
					<div class="card-body">
						<table class="table table-hover">
							<thead class="table-light">
								<tr>
									<th>#</th>
									<th>Period</th>
									<th>Locked By</th>
									<th>Locked At</th>
									<th>Actions</th>
								</tr>
							</thead>
							<tbody id="lockedPeriodsTableBody">
								<tr><td colspan="5" class="text-center text-muted">Loading...</td></tr>
							</tbody>
						</table>
					</div>
				</div>

				{{> attendance-modals }}
				<script src="/assets/js/admin-attendance.js"></script>
			</div>
		</div>
	</div>
</div>
 